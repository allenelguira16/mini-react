import u from"@babel/preset-react";import{declare as m}from"@babel/helper-plugin-utils";import*as e from"@babel/types";const x=m(c=>(c.assertVersion(7),{visitor:{Program(t,a){const r=a.filename||"";if(r.includes("/veltra-app/")||r.includes("\\veltra-app\\")||r.includes("/node_modules/@veltra/app/")||r.includes("\\node_modules\\@veltra\\app\\"))return;let f=!1;t.get("body").forEach(n=>{n.isImportDeclaration()&&n.node.source.value==="@veltra/app"&&n.node.specifiers.forEach(i=>{if(e.isImportSpecifier(i)){const o=i.imported;e.isIdentifier(o)&&o.name==="loop"&&(f=!0)}})});const s=[];if(f||s.push(e.importSpecifier(e.identifier("loop"),e.identifier("loop"))),s.length){const n=e.importDeclaration(s,e.stringLiteral("@veltra/app"));t.unshiftContainer("body",n)}},JSXExpressionContainer(t){const a=t.get("expression");function r(s){const n=s.node;if(e.isCallExpression(n)&&e.isMemberExpression(n.callee)&&e.isIdentifier(n.callee.property)&&n.callee.property.name==="map"){const i=n.arguments[0],o=n.callee.object;if(e.isArrowFunctionExpression(i)&&i.params.length>=2){const p=i.params[1];e.isIdentifier(p)&&e.traverseFast(i.body,l=>{if(e.isIdentifier(l)&&l.name===p.name){const d=e.memberExpression(e.identifier(p.name),e.identifier("value"));Object.assign(l,d)}})}return e.callExpression(e.memberExpression(e.callExpression(e.identifier("loop"),[e.arrowFunctionExpression([],o)]),e.identifier("each")),[i])}return null}function f(s){const n=s.node;if(e.isLogicalExpression(n)){const i=s.get("right"),o=r(i);o&&i.replaceWith(o)}else if(e.isConditionalExpression(n)){const i=s.get("consequent"),o=s.get("alternate"),p=r(i),l=r(o);p&&i.replaceWith(p),l&&o.replaceWith(l)}else{const i=r(s);i&&s.replaceWith(i)}}f(a)}}})),E=m(c=>(c.assertVersion(7),{visitor:{JSXExpressionContainer(t){const a=t.get("expression");e.isJSXEmptyExpression(a.node)||(t.node.expression=e.arrowFunctionExpression([],a.node))}}}));function g(c){return c.assertVersion(7),{presets:[[u,{runtime:"automatic",importSource:"@veltra/app"}]],plugins:[x,E]}}export{g as default};
//# sourceMappingURL=index.js.map
